# Refine Task Command

Converts a simple, manually-created GitHub issue into an actionable plan.

## Usage
`/refine-task --issue=<issue-number>`

## Instructions for AI

When the user runs this command:

1. **Fetch the GitHub issue** using the provided issue number
2. **Analyze the codebase** to understand technical context
3. **Generate a detailed implementation plan** including:
   - Technical approach
   - Files that need to be modified/created
   - Dependencies and considerations
   - Step-by-step breakdown
4. **Post the plan as a comment** on the original GitHub issue
5. **Confirm** that the issue now has a comprehensive plan for execution

This handles the common case where a PM or team member creates a simple issue that needs technical enrichment.

## Implementation Details

### Step 1: Fetch and Analyze Issue
- Use the GitHub API to fetch the issue content
- Read the issue title, body, and any existing comments
- Understand what the user is asking for

### Step 2: Codebase Analysis
- Examine the current project structure
- Identify relevant files and patterns
- Look for similar existing implementations
- Consider integration points and dependencies

### Step 3: Generate Implementation Plan
Create a comprehensive comment with this structure:

```markdown
## üõ†Ô∏è Implementation Plan

### Technical Approach
{Describe the overall technical strategy}

### Files to Modify/Create
- `path/to/file1.js` - {Description of changes needed}
- `path/to/file2.js` - {Description of changes needed}
- `tests/file.test.js` - {Test requirements}

### Dependencies & Prerequisites
- {List any new dependencies needed}
- {Environment setup requirements}
- {Configuration changes needed}

### Step-by-Step Implementation
1. **{Step 1 Title}**
   - {Detailed description}
   - {Specific code changes}

2. **{Step 2 Title}** 
   - {Detailed description}
   - {Integration considerations}

3. **Testing & Validation**
   - {Test strategy}
   - {Validation requirements}

### Potential Gotchas
- {Technical challenges to watch for}
- {Common pitfalls in this codebase}
- {Integration considerations}

### Acceptance Criteria (Updated)
- [ ] {Specific, testable criterion}
- [ ] {Another specific criterion}
- [ ] All tests pass
- [ ] Validation script passes (`./validate.sh`)

---
*This plan was generated by Context Engineering AI assistant*
```

### Step 4: Post to GitHub
- Post the implementation plan as a comment on the original issue
- Use appropriate GitHub API calls
- Handle authentication and error cases

### Step 5: Confirmation
- Confirm the comment was posted successfully
- Provide the user with next steps (`/start-task --issue=<number>`)

## Error Handling
- Handle invalid issue numbers gracefully
- Check for GitHub API authentication
- Verify the issue exists and is accessible
- Provide clear error messages

## Example Usage
```
User: /refine-task --issue=42
AI: üîç Fetching issue #42: "Add user settings page"
    üìã Analyzing codebase for technical context...
    ‚úçÔ∏è  Generating implementation plan...
    üí¨ Posted detailed implementation plan as comment
    ‚úÖ Issue #42 is now ready for development!
    üöÄ Next: /start-task --issue=42
```